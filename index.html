<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Email DNS Inspector</title>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Work+Sans:wght@400;500;600;700&display=swap" rel="stylesheet"/>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- üîí Styles: IDENTICAL to your original UI -->
  <style>
    /* ====== YOUR ORIGINAL CSS (UNCHANGED) ====== */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --primary-bg:#0a0e1a;--secondary-bg:#141927;--card-bg:#1a1f33;
      --border:#2a3246;--text-primary:#e8eaf0;--text-secondary:#9ca3af;
      --text-muted:#6b7280;--pass:#10b981;--warn:#f59e0b;--fail:#ef4444;
      --accent:#6366f1;--accent-hover:#4f46e5;
    }
    body {
      font-family:'Work Sans',sans-serif;
      background:var(--primary-bg);
      color:var(--text-primary);
      min-height:100vh;
    }
    .app-container { max-width:1400px;margin:auto;padding:3rem 2rem; }
    .header{text-align:center;margin-bottom:3rem;}
    .header h1{
      font-size:2.5rem;font-weight:700;
      background:linear-gradient(135deg,#6366f1,#8b5cf6);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    }
    .input-section,.section-card{
      background:var(--card-bg);border:1px solid var(--border);
      border-radius:12px;padding:1.5rem;margin-bottom:1.5rem;
    }
    .check-button{
      background:var(--accent);border:none;color:#fff;
      padding:1rem;border-radius:8px;font-weight:600;
      cursor:pointer;width:100%;
    }
    .check-button:hover{background:var(--accent-hover);}
    .section-header{
      display:flex;justify-content:space-between;cursor:pointer;
    }
    .status-badge{
      padding:.3rem .75rem;border-radius:6px;
      font-size:.75rem;font-weight:700;
    }
    .pass{color:var(--pass)}.warn{color:var(--warn)}.fail{color:var(--fail)}
    .code-block{
      background:var(--secondary-bg);
      border:1px solid var(--border);
      padding:1rem;border-radius:6px;
      font-family:'JetBrains Mono',monospace;
      font-size:.8rem;white-space:pre-wrap;word-break:break-all;
      margin-top:.75rem;
    }
    .dkim-selector{
      background:var(--secondary-bg);
      padding:1rem;border-radius:8px;margin-bottom:1rem;
    }
    .info-box{
      background:var(--secondary-bg);
      border-left:3px solid var(--accent);
      padding:1rem;border-radius:6px;margin-bottom:1rem;
    }
  </style>
</head>

<body>
<div id="root"></div>

<script type="text/babel">
const { useState } = React;
const API_URL = 'https://email-dns-backend.onrender.com';

/* ================= COMPONENTS ================= */

const StatusBadge = ({status}) => (
  <span className={`status-badge ${status.toLowerCase()}`}>{status}</span>
);

/* ================= MX ================= */
const MXSection = ({data}) => (
  <div className="section-card">
    <div className="section-header">
      <h3>MX Records</h3>
      <StatusBadge status={data.status}/>
    </div>

    {data.provider && (
      <div className="info-box">
        <strong>Detected Provider:</strong> {data.provider.name}<br/>
        <strong>Confidence:</strong> {data.provider.confidence}<br/>
        {data.provider.matchedBy && (
          <><strong>Matched MX:</strong> {data.provider.matchedBy}</>
        )}
      </div>
    )}

    <table>
      <tbody>
        {data.records.map((r,i)=>(
          <tr key={i}>
            <td>{r.priority}</td>
            <td>{r.exchange}</td>
          </tr>
        ))}
      </tbody>
    </table>
  </div>
);

/* ================= DKIM ================= */
const DKIMSection = ({data}) => (
  <div className="section-card">
    <div className="section-header">
      <h3>DKIM Records</h3>
      <StatusBadge status={data.status}/>
    </div>

    {data.selectors.map((s,i)=>(
      <div key={i} className="dkim-selector">
        <strong>{s.selector}._domainkey</strong><br/>
        üîë {s.keyType} | üìè {s.keySize}
        <div className="code-block">{s.record}</div>
      </div>
    ))}

    {data.selectors.length === 0 && (
      <div className="info-box">
        No DKIM records found on common selectors.
      </div>
    )}
  </div>
);

/* ================= REPUTATION ================= */
const ReputationSection = ({data}) => (
  <div className="section-card">
    <div className="section-header">
      <h3>Domain Reputation</h3>
      <StatusBadge status={
        data.level === 'Good' ? 'PASS' :
        data.level === 'Medium' ? 'WARN' : 'FAIL'
      }/>
    </div>

    <div className="info-box">
      <strong>Score:</strong> {data.score}/100<br/>
      <strong>Risk Level:</strong> {data.level}
    </div>

    {data.notes.map((n,i)=>(
      <div key={i} className="info-box">‚ö† {n}</div>
    ))}
  </div>
);

/* ================= APP ================= */
function App(){
  const [domain,setDomain]=useState('');
  const [results,setResults]=useState(null);

  const check = async ()=>{
    const res = await fetch(`${API_URL}/api/check`,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({domain})
    });
    setResults(await res.json());
  };

  return (
    <div className="app-container">
      <div className="header">
        <h1>Email DNS Inspector</h1>
        <p>Comprehensive email authentication & DNS analysis</p>
      </div>

      <div className="input-section">
        <input
          placeholder="example.com"
          value={domain}
          onChange={e=>setDomain(e.target.value)}
        />
        <button className="check-button" onClick={check}>
          Check DNS
        </button>
      </div>

      {results && (
        <>
          <MXSection data={results.mx}/>
          <DKIMSection data={results.dkim}/>
          <ReputationSection data={results.reputation}/>
        </>
      )}
    </div>
  );
}

ReactDOM.render(<App/>, document.getElementById('root'));
</script>
</body>
</html>
